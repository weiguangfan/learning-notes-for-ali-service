--odps sql
--********************************************************************--
--author:算法工程师-韦广繁
--create time:2021-12-10 17:30:33
--********************************************************************--
SELECT ascii('abcde');
SELECT ascii(NULL );
SELECT char_matchcount('aabc','abcde');
SELECT char_matchcount(NULL ,'abcde');
SELECT CHR(100);
SELECT CHR(200);
SELECT CHR(NULL);
-- SELECT CHR('100');
SELECT CONCAT(array(10,20),array(20,-20));
SELECT CONCAT(ARRAY(10,NULL),ARRAY (20,-20));
SELECT CONCAT(ARRAY (10,20),NULL );
SELECT CONCAT('aabc','abcde');
SELECT CONCAT();
SELECT CONCAT('aabc','abcde',NULL );
setproject odps.sql.type.system.odps2=true;
SELECT encode('abc','utf-8');
SELECT encode('abc','utf-16be');
SELECT encode('abc',NULL );
SELECT find_in_set('ab','abc,hello,ab,c');  
SELECT find_in_set('hi','abc,hello,ab,c');
SELECT find_in_set(NULL,'abc,hello,ab,c');
SELECT format_number(5.2301345,3);
SELECT format_number(5.2301345,0);
SELECT format_number(5.2301345,-2);
SELECT format_number(12332.123456,'#,###,###,###.###');
SELECT format_number('',3);
SELECT format_number(NULL ,3);
select from_json('{"a":1, "b":0.8}', 'a int, b double');
SELECT from_json('{"a":1,"b":0.8}','a int,b int');
SELECT from_json('{"a":1,"b":0.8}','a string,b string');
select from_json('{"time":"26/08/2015"}', 'time string');
-- select from_json('{"time":"26/08/2015"}','time datetime');
-- select from_json('{"time":"26/08/2015"}','time date');
-- SELECT from_json('{"time":"26/08/2015"}','time int');
select from_json('{"a":1, "b":0.8}', 'a int, b double, c string');
select from_json('[1, 2, 3, "a"]', 'array<bigint>');
select from_json('{"a":1,"b":[1,2,3],"c":{},"d":"v"}', 'map<string, string>');
SELECT map_keys(from_json('{"a":1,"b":2}','map<string,string>'));
set odps.sql.udf.getjsonobj.new=FALSE ;
SELECT GET_JSON_OBJECT('{"a":"1","a":"2"}','$.a');
set odps.sql.udf.getjsonobj.new=FALSE ;
SELECT get_json_object('{"a":"1","b":"2"}','$.a');
set odps.sql.udf.getjsonobj.new=FALSE ;
SELECT get_json_object('{"a":"<Emoji符号>"}','$.a');
set odps.sql.udf.getjsonobj.new=FALSE ;
SELECT get_json_object('{"b":1,"a":2}','$');
SELECT get_json_object('{"a":"<Emoji符号>"}','$.a');
SELECT get_json_object('{"b":1,"a":2}','$');
select get_json_object('{"a":"[\\"1\\"]"}', '$.a');
select get_json_object('{"array":[["aaaa",1111],["bbbb",2222],["cccc",3333]]}','$.array[1][1]');
select get_json_object('{"aaa":"bbb","ccc":{"ddd":"eee","fff":"ggg","hhh":["h0","h1","h2"]},"iii":"jjj"}','$.ccc.hhh[*]');
set odps.sql.udf.getjsonobj.new=false;
select get_json_object('{"aaa":"bbb","ccc":{"ddd":"eee","fff":"ggg","hhh":["h0","h1","h2"]},"iii":"jjj"}','$.ccc.hhh');
select get_json_object('{"aaa":"bbb","ccc":{"ddd":"eee","fff":"ggg","hhh":["h0","h1","h2"]},"iii":"jjj"}','$.ccc.hhh[1]');
select get_json_object('','$.array[1][1]');
select get_json_object('"array":["aaaa",1111],"bbbb":["cccc",3333]','$.array[1][1]');
select get_json_object('{"a":"\\"1\\"","b":"2"}', '$.a');
select get_json_object('{"a":"\'1\'","b":"2"}', '$.a');
SELECT INSTR('Tech on the net','e');
SELECT INSTR('Tech on the net','on');
SELECT INSTR('Tech on the net','e',3,2);
SELECT INSTR('Tech on the net',NULL);
SELECT is_encoding('测试','utf-8','gbk');
SELECT is_encoding('測試','utf-8','gbk');
SELECT is_encoding('測試','utf-8','gb2312');
SELECT is_encoding('测试','utf-8',NULL);
select keyvalue('0:1\;1:2', 1);
select keyvalue("\;decreaseStore:1\;xcard:1\;isB2C:1\;tf:21910\;cart:1\;shipping:2\;pf:0\;market:shoes\;instPayAmount:0\;","\;",":","tf");
SELECT LENGTH('Tech on the net');
SELECT length(null);
SELECT lengthb('Tech on the net');
SELECT lengthb(null);
select locate('ab', 'abchelloabc');
select locate('ab', 'abcheablloabc',3);
select locate('hi', 'abc,hello,ab,c');
SELECT locate('ab',null);
select locate('ab','cfeabde',null);
SELECT ltrim('   I am happy!');
SELECT ltrim(null);
SELECT md5('Tech on the net');
SELECT md5(null);
select parse_url('file://username:password@example.com:8042/over/there/index.dtb?type=animal&name=narwhal#nose', 'HOST');
select parse_url('file://username:password@example.com:8042/over/there/index.dtb?type=animal&name=narwhal#nose', 'PATH');
select parse_url('file://username:password@example.com:8042/over/there/index.dtb?type=animal&name=narwhal#nose', 'QUERY', 'type');
select parse_url('file://username:password@example.com:8042/over/there/index.dtb?type=animal&name=narwhal#nose', 'REF');
select parse_url('file://username:password@example.com:8042/over/there/index.dtb?type=animal&name=narwhal#nose', 'PROTOCOL');
select parse_url('file://username:password@example.com:8042/over/there/index.dtb?type=animal&name=narwhal#nose', 'AUTHORITY');
select parse_url('file://username:password@example.com:8042/over/there/index.dtb?type=animal&name=narwhal#nose', 'USERINFO');
select parse_url_tuple('file://username:password@example.com:8042/over/there/index.dtb?type=animal&name=narwhal#nose', 'HOST', 'PATH', 'QUERY', 'REF', 'PROTOCOL', 'AUTHORITY', 'FILE', 'USERINFO', 'QUERY:type', 'QUERY:name') as (item0, item1, item2, item3, item4, item5, item6, item7, item8, item9);
SELECT regexp_count('abababc','a.c');
select regexp_count('abababc','[[:alpha:]]{2}',3);
SELECT regexp_count('abababc',NULL);
select regexp_extract('foothebar','foo(.*?)(bar)');
select regexp_extract('foothebar','foo(.*?)(bar)',0);
select regexp_extract('8d99d8','8d(\\d+)d8');
SELECT REGEXP_EXTRACT('【阿里云】aliyun','([^\\x{00}-\\x{ff}]+)');
select regexp_extract('【阿里云】aliyun','([\\x{4e00}-\\x{9fa5}]+)');
-- select regexp_extract('foothebar','foothebar');
select regexp_instr('I love www.taobao.com','o[[:alpha:]]{1}',3,2);
select regexp_instr('I love www.taobao.com','o[[:alpha:]]{1}',3,2,0);
SELECT REGEXP_INSTR('I love www.taobao.com','o[[:alpha:]]{1}',3,2,1);
SELECT REGEXP_INSTR('I love www.taobao.com',NULL ,3,2);
SELECT regexp_replace('123.456.7890','([[:digit:]]{3})\\.([[:digit:]]{3})\\.([[:digit:]]{4})','(\\1)\\2-\\3',0);
SELECT regexp_replace('123.456.7890','([[:digit:]]{3})\\.([[:digit:]]{3})\\.([[:digit:]]{4})','(\\1)\\2-\\3',1);
SELECT regexp_replace('abcd','(.)','\\1',0);
SELECT REGEXP_REPLACE('abcd','(.)','\\1',1);
SELECT REGEXP_REPLACE('abcd','(.)','\\2',1);
select regexp_replace('abcd', '(.)', null, 0);
SELECT regexp_replace("abcd", "(.*)(.)$", "\\2", 0);
SELECT regexp_replace("abcd", "a", "\\1", 0);
select regexp_substr('I love aliyun very much', 'a[[:alpha:]]{5}');
select regexp_substr('I have 2 apples and 100 bucks!', '[[:blank:]][[:alnum:]]*', 1, 1);
select regexp_substr('I have 2 apples and 100 bucks!', '[[:blank:]][[:alnum:]]*', 1, 2);
select regexp_substr('I love aliyun very much', null);
select repeat('abc', 5);
select repeat('abc', null);
select reverse('I love aliyun very much');
select reverse(null);
select rtrim(' I love aliyun very much ');
select rtrim(null);
select length(space(10));
SELECT space(10);
select split_part('a,b,c,d', ',', 1);
select split_part('a,b,c,d', ',', 1, 2);
select split_part('a,b,c,d', ',', 10);
select split_part('a,b,c,d', ':', 1);
select split_part('a,b,c,d', ':', 2);
select split_part('a,b,c,d', '', 1);
select split_part('a,b,c,d', ',', 2, 6);
select split_part('a,b,c,d', ',', null);
select substr('abc', 2);
select substr('abc', 2, 1);
select substr('abc',-2 , 2);
select substr('abc', null);
select substring('abc', 2);
select substring('abc', 2, 1);
select substring('abc',-2,2);
select substring('abc',-3,2);
SELECT  substring(bin(2345), 2, 3);
select substring('abc', null, null);
select to_char(123);
select to_char(true);
select to_char(1.23);
select to_char(null);
select to_json(named_struct('a', 1, 'b', 2));
select to_json(named_struct('time', "26/08/2015"));
select to_json(array(named_struct('a', 1, 'b', 2)));
select to_json(map('a', named_struct('b', 1)));
select to_json(map('a', 1));
select to_json(array((map('a', 1))));
select to_json(named_struct("A", "B"));
select to_json(named_struct("k1", cast(null as string), "k2", "v2"));
select tolower('aBcd');
select tolower('中国Fighting');
select tolower(null);
select toupper('aBcd');
select toupper('中国Fighting');
select toupper(null);
select trim(' I love aliyun very much ');
select trim(null);
select url_decode('%E7%A4%BA%E4%BE%8Bfor+url_decode%3A%2F%2F+%28fdsf%29');
select url_decode('Example+for+url_decode+%3A%2F%2F+dsf%28fasfs%29', 'GBK');
select url_encode('示例for url_encode:// (fdsf)');
select url_encode('Example for url_encode:// dsf(fasfs)', 'GBK');
select concat_ws(':','name','hanmeimei');
select concat_ws(':','avg',null,'34');
select concat_ws(':',array('name', 'hanmeimei'));
select lpad('abcdefgh', 10, '12');
select lpad('abcdefgh', 5, '12');
select lpad('abcdefgh' ,0, '12');
select lpad(null ,0, '12');
select rpad('abcdefgh', 10, '12');
select rpad('abcdefgh', 5, '12');
select rpad('abcdefgh' ,0, '12');
select rpad(null ,0, '12');
select replace('ababab','abab','12');
select replace('123abab456ab',null,'abab');
select soundex('hello');
select soundex(null);
select substring_index('https://help.aliyun.com', '.', 2);
select substring_index('https://help.aliyun.com', '.', -2);
select substring_index('https://help.aliyun.com', null, 2);
select translate('MaxComputer','puter','pute');
select translate('MaxComputer','puter',null);
